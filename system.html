<!DOCTYPE html>
<html>
<head>
    <title>OXYLUS_PROTOCOL v4.0 - Control System</title>
    <meta charset="utf-8">
    <style>
        /* [Keep all previous CSS styles exactly as before] */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: #000;
            color: #0f0;
            height: 100vh;
            overflow: hidden;
        }
        
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 255, 0, 0.03) 50%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 1;
        }
        
        /* ... [All previous CSS remains exactly the same] ... */
        
    </style>
</head>
<body>
    <div class="scanlines"></div>
    
    <!-- Loading Screen -->
    <div id="loadingScreen" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #000;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        color: #0f0;
        font-family: 'Courier New', monospace;
        font-size: 14px;
    ">
        <div style="text-align: center;">
            <div style="margin-bottom: 20px;">OXYLUS_PROTOCOL v4.0</div>
            <div id="loadingText">Verifying session...</div>
            <div style="margin-top: 20px;">
                <span class="loader-dot"></span>
                <span class="loader-dot"></span>
                <span class="loader-dot"></span>
            </div>
        </div>
    </div>
    
    <div class="container" style="display: none;" id="mainContainer">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">OXYLUS_PROTOCOL</div>
            <div class="menu">
                <button class="menu-btn active" onclick="showModule('dashboard')">üìä Dashboard</button>
                <button class="menu-btn" onclick="showModule('ddos')">‚ö° DDoS Attack</button>
                <button class="menu-btn" onclick="showModule('ngl')">üí¨ NGL Spam</button>
                <button class="menu-btn" onclick="showModule('scanner')">üîç Target Scanner</button>
                <button class="menu-btn" onclick="showModule('multi')">üéØ Multi-Target</button>
                <button class="menu-btn" onclick="showModule('scheduler')">‚è∞ Scheduler</button>
                <button class="menu-btn" onclick="showModule('logs')">üìù System Logs</button>
                <button class="menu-btn" onclick="showModule('help')">‚ùì Help & Commands</button>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Module -->
            <div id="dashboard" class="module active">
                <h2 class="module-title">System Dashboard</h2>
                <div id="console">
[SYSTEM] OXYLUS_PROTOCOL v4.0 Initialized
[STATUS] Authentication: ‚úì Valid
[TIME] System ready for commands
[INFO] Type commands in browser console (F12)
[INFO] Use "help()" for command list

Available Modules:
1. DDoS Attack Engine
2. NGL Spam System
3. Target Scanner
4. Multi-Target Operations
5. Attack Scheduler

System Status:
‚úì DDoS Module: Ready
‚úì NGL Module: Ready
‚úì Scanner: Ready
‚úì Memory: Optimal
‚úì Connection: Secure
                </div>
                <button class="btn" onclick="runTest()">Run System Test</button>
                <button class="btn" onclick="clearConsole()">Clear Console</button>
            </div>
            
            <!-- DDoS Module -->
            <div id="ddos" class="module">
                <h2 class="module-title">DDoS Attack Module</h2>
                <div class="input-group">
                    <label class="input-label">Target IP/Domain</label>
                    <input type="text" id="ddosTarget" class="input-field" placeholder="example.com or 192.168.1.1">
                </div>
                <div class="input-group">
                    <label class="input-label">Port (Default: 80)</label>
                    <input type="number" id="ddosPort" class="input-field" value="80">
                </div>
                <div class="input-group">
                    <label class="input-label">Intensity</label>
                    <select id="ddosIntensity" class="input-field">
                        <option value="low">Low (50 RPS)</option>
                        <option value="med" selected>Medium (200 RPS)</option>
                        <option value="hard">Hard (500 RPS)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label class="input-label">Duration (seconds, 0 = unlimited)</label>
                    <input type="number" id="ddosDuration" class="input-field" value="60">
                </div>
                <button class="btn" onclick="startDDoS()">Launch Attack</button>
                <button class="btn btn-danger" onclick="stopDDoS()">Stop Attack</button>
            </div>
            
            <!-- NGL Module -->
            <div id="ngl" class="module">
                <h2 class="module-title">NGL Spam Module</h2>
                <div class="input-group">
                    <label class="input-label">NGL Link or Username</label>
                    <input type="text" id="nglTarget" class="input-field" placeholder="ngl.link/username or just username">
                </div>
                <div class="input-group">
                    <label class="input-label">Message to Send</label>
                    <textarea id="nglMessage" class="input-field" rows="3" placeholder="Enter your message here..."></textarea>
                </div>
                <div class="input-group">
                    <label class="input-label">Number of Messages</label>
                    <input type="number" id="nglCount" class="input-field" value="20" min="1" max="1000">
                </div>
                <div class="input-group">
                    <label class="input-label">Delay between messages (ms)</label>
                    <input type="number" id="nglDelay" class="input-field" value="2000" min="1000">
                </div>
                <button class="btn" onclick="startNGL()">Start Spam</button>
                <button class="btn btn-danger" onclick="stopNGL()">Stop Spam</button>
            </div>
            
            <!-- Add more modules as needed -->
        </div>
    </div>
    
    <!-- Status Bar -->
    <div class="status-bar" style="display: none;" id="statusBar">
        <div class="status-item">STATUS: <span id="sysStatus" style="color:#0f0">Ready</span></div>
        <div class="status-item">USER: <span style="color:#0f0">AUTHORIZED</span></div>
        <div class="status-item">TIME: <span id="currentTime">--:--:--</span></div>
        <div class="status-item">MEMORY: <span id="memoryUsage">-- MB</span></div>
        <div class="status-item">SESSION: <span id="sessionTimer">--:--</span></div>
    </div>
    
    <!-- Logout Button -->
    <button class="logout-btn" onclick="logout()" style="display: none;" id="logoutBtn">Logout</button>
    
    <script>
        // SESSION MANAGEMENT SYSTEM
        class SessionManager {
            constructor() {
                this.sessionId = null;
                this.sessionStart = null;
                this.maxSessionHours = 12;
                this.checkInterval = null;
            }
            
            // Validate session
            validateSession() {
                // Check localStorage
                const storedSession = localStorage.getItem('oxylus_session');
                const storedTime = localStorage.getItem('oxylus_session_time');
                
                // Check URL parameters (from redirect)
                const urlParams = new URLSearchParams(window.location.search);
                const urlSession = urlParams.get('session');
                
                // Multiple validation checks
                if(!storedSession || !storedTime) {
                    console.log('[SESSION] No session found in localStorage');
                    return false;
                }
                
                // Check session age
                const now = Date.now();
                const sessionAge = now - parseInt(storedTime);
                const maxAge = this.maxSessionHours * 60 * 60 * 1000;
                
                if(sessionAge > maxAge) {
                    console.log('[SESSION] Session expired');
                    this.clearSession();
                    return false;
                }
                
                // If URL has session param, verify it matches
                if(urlSession && urlSession !== 'valid') {
                    console.log('[SESSION] URL session parameter invalid');
                    return false;
                }
                
                // Set session data
                this.sessionId = storedSession;
                this.sessionStart = parseInt(storedTime);
                
                console.log(`[SESSION] Valid session found: ${this.sessionId}`);
                console.log(`[SESSION] Age: ${Math.round(sessionAge/1000)} seconds`);
                
                return true;
            }
            
            // Create new session (not used here, but available)
            createSession() {
                const sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('oxylus_session', sessionId);
                localStorage.setItem('oxylus_session_time', Date.now().toString());
                this.sessionId = sessionId;
                this.sessionStart = Date.now();
                return sessionId;
            }
            
            // Clear session (logout)
            clearSession() {
                localStorage.removeItem('oxylus_session');
                localStorage.removeItem('oxylus_session_time');
                localStorage.removeItem('oxylus_auth');
                
                // Clear cookies
                document.cookie = "oxylus_session=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
                
                this.sessionId = null;
                this.sessionStart = null;
                
                console.log('[SESSION] Session cleared');
            }
            
            // Get session time remaining
            getTimeRemaining() {
                if(!this.sessionStart) return '00:00';
                
                const now = Date.now();
                const elapsed = now - this.sessionStart;
                const maxMs = this.maxSessionHours * 60 * 60 * 1000;
                const remainingMs = maxMs - elapsed;
                
                if(remainingMs <= 0) return '00:00';
                
                const hours = Math.floor(remainingMs / (1000 * 60 * 60));
                const minutes = Math.floor((remainingMs % (1000 * 60 * 60)) / (1000 * 60));
                
                return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
            }
            
            // Start session monitoring
            startMonitoring() {
                // Update timer every minute
                this.checkInterval = setInterval(() => {
                    const timeRemaining = this.getTimeRemaining();
                    document.getElementById('sessionTimer').textContent = timeRemaining;
                    
                    // Auto-logout when time expires
                    if(timeRemaining === '00:00') {
                        this.clearSession();
                        alert('Session expired. Please login again.');
                        window.location.href = 'index.html';
                    }
                }, 60000); // Check every minute
                
                // Initial update
                document.getElementById('sessionTimer').textContent = this.getTimeRemaining();
            }
            
            // Stop monitoring
            stopMonitoring() {
                if(this.checkInterval) {
                    clearInterval(this.checkInterval);
                }
            }
        }
        
        // Initialize session manager
        const sessionManager = new SessionManager();
        
        // Main initialization function
        function initializeSystem() {
            const loadingScreen = document.getElementById('loadingScreen');
            const mainContainer = document.getElementById('mainContainer');
            const statusBar = document.getElementById('statusBar');
            const logoutBtn = document.getElementById('logoutBtn');
            const loadingText = document.getElementById('loadingText');
            
            // Step 1: Validate session
            loadingText.textContent = 'Validating session...';
            
            setTimeout(() => {
                if(sessionManager.validateSession()) {
                    // Session valid
                    loadingText.textContent = 'Session valid. Loading system...';
                    
                    setTimeout(() => {
                        // Hide loading, show system
                        loadingScreen.style.display = 'none';
                        mainContainer.style.display = 'flex';
                        statusBar.style.display = 'flex';
                        logoutBtn.style.display = 'block';
                        
                        // Start session monitoring
                        sessionManager.startMonitoring();
                        
                        // Initialize system components
                        initSystemComponents();
                        
                    }, 1000);
                    
                } else {
                    // Session invalid
                    loadingText.textContent = 'Invalid or expired session. Redirecting...';
                    
                    setTimeout(() => {
                        // Clear any invalid session data
                        sessionManager.clearSession();
                        
                        // Redirect to login
                        window.location.href = 'index.html';
                    }, 2000);
                }
            }, 1500);
        }
        
        // System component initialization
        function initSystemComponents() {
            // Set up OXYLUS global object
            window.OXYLUS = window.OXYLUS || {};
            window.OXYLUS.authenticated = true;
            window.OXYLUS.session = sessionManager.sessionId;
            
            // Display welcome message
            const consoleEl = document.getElementById('console');
            consoleEl.innerHTML += '\n[SYSTEM] Session validated successfully';
            consoleEl.innerHTML += '\n[SYSTEM] System fully initialized';
            consoleEl.innerHTML += '\n[SYSTEM] All modules ready for operation';
            consoleEl.scrollTop = consoleEl.scrollHeight;
            
            // Start system functions
            startSystemFunctions();
        }
        
        // System functions
        function startSystemFunctions() {
            updateTime();
            updateMemory();
            
            // Update time and memory every second
            setInterval(() => {
                updateTime();
                updateMemory();
            }, 1000);
            
            // Auto-focus on first input
            document.getElementById('ddosTarget')?.focus();
        }
        
        // Helper functions
        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString();
            document.getElementById('currentTime').textContent = timeStr;
        }
        
        function updateMemory() {
            if(performance.memory) {
                const used = Math.round(performance.memory.usedJSHeapSize / 1048576);
                document.getElementById('memoryUsage').textContent = `${used} MB`;
            }
        }
        
        function showModule(moduleId) {
            // Hide all modules
            document.querySelectorAll('.module').forEach(m => {
                m.classList.remove('active');
            });
            
            // Deactivate all menu buttons
            document.querySelectorAll('.menu-btn').forEach(b => {
                b.classList.remove('active');
            });
            
            // Show selected module
            document.getElementById(moduleId).classList.add('active');
            
            // Activate corresponding button
            event.target.classList.add('active');
        }
        
        function runTest() {
            const consoleEl = document.getElementById('console');
            consoleEl.innerHTML += '\n[TEST] Running system diagnostics...';
            consoleEl.innerHTML += '\n[TEST] ‚úì Network connectivity';
            consoleEl.innerHTML += '\n[TEST] ‚úì JavaScript engine';
            consoleEl.innerHTML += '\n[TEST] ‚úì Web Workers available';
            consoleEl.innerHTML += '\n[TEST] ‚úì System ready for operations';
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }
        
        function clearConsole() {
            document.getElementById('console').innerHTML = '[SYSTEM] Console cleared';
        }
        
        // Logout function
        function logout() {
            if(confirm("Are you sure you want to logout?")) {
                // Stop session monitoring
                sessionManager.stopMonitoring();
                
                // Clear session
                sessionManager.clearSession();
                
                // Redirect to login
                window.location.href = 'index.html';
            }
        }
        
        // DDoS functions
        function startDDoS() {
            const target = document.getElementById('ddosTarget').value;
            const port = document.getElementById('ddosPort').value;
            const intensity = document.getElementById('ddosIntensity').value;
            const duration = document.getElementById('ddosDuration').value;
            
            if(!target) {
                alert('Please enter a target');
                return;
            }
            
            document.getElementById('sysStatus').textContent = 'Attacking';
            document.getElementById('sysStatus').style.color = '#ff0';
            
            // Call DDoS engine
            console.log(`Starting DDoS on ${target}:${port} with ${intensity} intensity`);
            
            // In real implementation, this would call OXYLUS.ddos.target()
            const consoleEl = document.getElementById('console');
            consoleEl.innerHTML += `\n[DDoS] üöÄ Attack launched on ${target}:${port}`;
            consoleEl.innerHTML += `\n[DDoS] Intensity: ${intensity.toUpperCase()}`;
            consoleEl.innerHTML += `\n[DDoS] Duration: ${duration}s`;
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }
        
        function stopDDoS() {
            document.getElementById('sysStatus').textContent = 'Ready';
            document.getElementById('sysStatus').style.color = '#0f0';
            
            const consoleEl = document.getElementById('console');
            consoleEl.innerHTML += '\n[DDoS] üõë Attack stopped';
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }
        
        // NGL functions
        function startNGL() {
            const target = document.getElementById('nglTarget').value;
            const message = document.getElementById('nglMessage').value;
            const count = document.getElementById('nglCount').value;
            const delay = document.getElementById('nglDelay').value;
            
            if(!target || !message) {
                alert('Please enter target and message');
                return;
            }
            
            document.getElementById('sysStatus').textContent = 'Spamming';
            document.getElementById('sysStatus').style.color = '#ff0';
            
            const consoleEl = document.getElementById('console');
            consoleEl.innerHTML += `\n[NGL] üöÄ Starting spam on ${target}`;
            consoleEl.innerHTML += `\n[NGL] Message: "${message.substring(0, 50)}..."`;
            consoleEl.innerHTML += `\n[NGL] Count: ${count} messages`;
            consoleEl.scrollTop = consoleEl.scrollHeight;
            
            // In real implementation, this would call OXYLUS.ngl.spam()
        }
        
        function stopNGL() {
            document.getElementById('sysStatus').textContent = 'Ready';
            document.getElementById('sysStatus').style.color = '#0f0';
            
            const consoleEl = document.getElementById('console');
            consoleEl.innerHTML += '\n[NGL] üõë Spam stopped';
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }
        
        // Add loader dots animation
        const loaderStyle = document.createElement('style');
        loaderStyle.textContent = `
            .loader-dot {
                display: inline-block;
                width: 8px;
                height: 8px;
                background: #0f0;
                border-radius: 50%;
                margin: 0 4px;
                animation: loaderDots 1.4s infinite ease-in-out both;
            }
            
            .loader-dot:nth-child(1) { animation-delay: -0.32s; }
            .loader-dot:nth-child(2) { animation-delay: -0.16s; }
            
            @keyframes loaderDots {
                0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
                40% { transform: scale(1); opacity: 1; }
            }
        `;
        document.head.appendChild(loaderStyle);
        
        // Start system initialization when page loads
        document.addEventListener('DOMContentLoaded', initializeSystem);
    </script>
    
    <!-- Include external scripts -->
    <script src="auth.js"></script>
    <script src="ddos-engine.js"></script>
    <script src="ngl-spammer.js"></script>
    <script src="advanced-modules.js"></script>
</body>
</html>
    
